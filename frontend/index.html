<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat app </title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- join section -->
 <div id="joinSection">
  <h1>Enter Your Name to Start Chat</h1>
  <input type="text" id="username" placeholder="Enter your name" />
  <button id="joinBtn">Join Chat</button>
</div>

  <div class=" chat_container" style="display:none;">
    <div class="chat-card">
      <h1>Real Time Chat</h1>

      <ul id="messages"></ul>

      <form>
        <input type="text" id="messageInput" placeholder="Type your message..." />
         
        <button type="submit" id="submit_button">Send</button>
      </form>
    </div>
  </div>

<!-- script file -->
 <!-- <script src="https://real-time-chat-app-1-3tv1.onrender.com/socket.io/socket.io.js"></script> -->
<!-- <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script> -->
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>


<script>
  // backend se connection ke time only use this url
  // const socket = io('https://real-time-chat-app-1-3tv1.onrender.com');
  // const socket = io();
  const socket = io("http://localhost:3000");



// const input = document.querySelector('input');
const input = document.getElementById('messageInput');

const btn = document.querySelector('#submit_button');
const form = document.querySelector('form');
const messages = document.querySelector('#messages');
const usernameInput = document.querySelector('#username');
const joinbtn = document.querySelector('#joinBtn');
const joinSection = document.getElementById('joinSection');
const chatContainer = document.querySelector('.chat_container');


let username = '';

joinbtn.addEventListener('click', ()=> 
{
  username= usernameInput.value.trim();

    if (!username) {
    alert("Please enter name");
    return;
  }

  socket.emit("setUsername", username);

  joinSection.style.display='none';
  chatContainer.style.display = 'block';
  

});


form.addEventListener('submit', (e) => {
  e.preventDefault();

  if (input.value.trim() === '') return;

  socket.emit('messageSend', input.value);
  input.value = '';
});

  socket.on('message_Distributed_by server', (data) => {
    // console.log(data);
    console.log("Received data from backend : ", data);
    const li = document.createElement('li');
    // li.textContent = msg;
      li.textContent = `${data.name}: ${data.message}`;
    messages.appendChild(li);

  });

</script>
  
</body>
</html>